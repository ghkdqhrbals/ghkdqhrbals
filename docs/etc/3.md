---
layout: default
title: XSS and CSRF 공격
parent: 기타
nav_order: 3
---

## reference
* [CSRF Demystified](https://www.gnucitizen.org/blog/csrf-demystified/)
* [Understanding CSRF](https://security.stackexchange.com/questions/138987/difference-between-xss-and-csrf)

## Cookie

**velog**.io 에서는 JWT 토큰을 통한 인증방식을 사용합니다.

그리고 토큰을 쿠키에다가 아래와 같은 옵션을 주어 저장하죠.

* `HttpOnly` 를 통해 HttpRequest를 통해서만 cookie 정보를 전달할 수 있습니다(`document.cookie` 명령어 제한을 통해 쿠키 접근을 제한합니다.).
* `Secure` 옵션을 통해 Https 에서만 cookie 정보를 전송합니다.

왜 위의 옵션이 필요할까요?

위의 옵션을 설정함으로써 **velog.io** 는 XSS 공격 중 쿠키를 빼오는 부분을 조금은 제한할 수 있습니다.
> **XSS** 공격이란? : 일반적인 형태는 공격자가 게시판에 악성 스크립트를 포스팅하고, 희생자가 이 글을 열 때 실행되는 형태입니다(이는 세부적인 형태로 stored XSS 공격이라고 합니다). 악성 스크립트의 예로 `document.cookie` 를 실행하여 공격자가 뽑아낼 수 있는 형태의 스크립트가 있죠.

하지만 희생자가 로그인하여 cookie 에 `로그인 토큰`이 저장되어 있다면 어떻게 될까요?

앞서 말씀드렸듯 **HttpOnly 는 `document.cookie` 명령어만 제한**합니다. request 는 가능하다는 것이죠. ajax 로 request 하는 악성 스크립트가 포스팅 되버리면 **여전히 XSS 공격이 성공**합니다.

이렇게 인증정보(e.g. 토큰, etc.)를 가지고 다른 요청을 보내는 것은 CSRF 공격이라고도 합니다.

CSRF 는 XSS 베이스에서 몇 가지 조건이 붙은 공격입니다.
1. 희생자가 **velog**.io 에 로그인하여 쿠키에 토큰이 저장되어있어야한다.
2. 희생자가 피싱사이트에 접속해야한다.
> 피싱사이트는 ajax 로 request 하는 악성 스크립트를 자동실행합니다.



