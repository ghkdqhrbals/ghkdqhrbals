---
layout: default
title: RSA 암호화 원리
parent: Cryptography
nav_order: 1
---

created at 2024-09-01
{: .label .label-yellow }


RSA 암호화/복호화 과정 설명함.

### 1. 기본 설정
- **소수 p, q:** 53, 59
- **n:** p*q = 3127
- **Φ(n):** (p-1)*(q-1) = 3016
- **k:** 임의 숫자, 2로 설정함.
- **공개 지수 e:** 작은 홀수로 n과 공약수 없게 설정만 하면 됨. 여기서는 3으로 설정해봄
- **비밀 키 d:** (k * Φ(n) + 1) / e = 2011

공개 키 e와 n (3, 3127). 비밀 키 d = 2011.

### 2. RSA 암호화
- 평문 m -> 암호화 c(m) : **c(m) = m^e (mod n)**

### 3. RSA 복호화
- 암호문 c(m) -> 평문 복호화 : **m = c^d (mod n)**

d 비밀 키. **e*d ≡ 1 mod n** 만족함.

### 4. RSA 복호화 원리
복호화 과정 수학적으로 증명함.

d는 아래처럼 최종정의 될 수 있음

- = (kΦ(n)+1)/e
- = (kΦ(pq)+1)/e (mod n)
- = (kΦ(q)Φ(q)+1)/e (mod n)
- = (k(p-1)(q-1)+1)/e (mod n)

즉, d = (k(p-1)(q-1)+1)/e (mod n)

이렇게 생긴 d 를 **m = c^d (mod n)** 식에 대입하면? 

- = m^(e*d) (mod n)
- = m^(k(p-1)(q-1)+1) (mod n)
- = (m^(k*(p-1)*(q-1)) mod n) * (m mod n)

여기에 페르마의 소정리, 중국인의 나머지 정리 적용

- m^(k*(p-1)*(q-1)) (mod p) = 1 (mod p)
- m^(k*(p-1)*(q-1)) (mod q) = 1 (mod q)

결론:
- **m^(k*(p-1)*(q-1)) = 1 (mod pq)**
- **m = c^d (mod n) = m mod n**

결국, m = c^d (mod n) 성립, 평문 m 얻을 수 있음.

### 5. RSA 공격 가능성
RSA 암호화 안전한지 검토함. 공격자 c 가로채서 c' = c * r^e (r은 임의 값)로 바꾸고, 수신자에게 전송함. 수신자 복호화:
- **c'^d = (c * r^e)^d = (m*r)^(e*d) = m*r (mod n)**

공격자 r 값 알고 있으면 평문 m 쉽게 계산 가능함. 공격 방지 위해 메시지에 패딩 추가함. 이 패딩 방식 OAEP(Optimal Asymmetric Encryption Padding)라 부름. 매번 다른 패딩 적용, 공격자가 평문 알아낼 수 없게 함.

### 6. OAEP 패딩 스킴
- **MGF (Mask Generating Function):** 입력 문자열 원하는 길이 출력 문자열로 변환함.
- **예시 (MGF1):** 라벨 L 해시 함수로 해싱, 결과 이용해 패딩 문자열 PS 생성, DB = Hash(L) || PS || 0x01 || m 형태로 결합함.

그러나 OAEP도 패딩 오라클 공격에 취약할 수 있음. 특히, RSA-PKCS#1 v1.5에서는 문제 심각함, 이 패딩 스킴 가능한 대체해야 함.

### 7. 안전한 패딩 스킴
안전한 패딩 스킴 RSA-PSS(Probabilistic Signature Scheme) 등 있음, 메시지 서명과 암호화 모두 필수적임.

### 8. RSAES-PKCS1.5 패딩 스킴
마지막으로 RSAES-PKCS1.5 설명함.

평문 'HI' 숫자로 변환: H = 8, I = 9. 이를 암호화:
- **암호화된 데이터 c(m) = m^e (mod n) = 89^3 (mod 3127) = 1394**
- **복호화된 데이터 m(c) = c^d (mod n) = c^2011 (mod 3127) = 89**

패딩된 메시지(89) 모듈러스(3127)보다 길 수 없음, 원시 메시지에 엄격한 최대 길이 적용됨.

### 9. 요약
RSA 암호화/복호화 과정 수학적으로 안전함. 패딩 없을 경우 공격에 취약할 수 있음. 이를 방지 위해 다양한 패딩 스킴 존재, 올바르게 사용해야 함.
